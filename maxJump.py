from typing import List
class Solution:
    def maxJumps(self, arr: List[int], d: int) -> int:
        def get_valid_neig(index):
            doing_pos = True
            doing_neg = True
            for i in range(1, d+1):
                if doing_pos and index + i < len(arr):
                    if arr[index+i]< arr[index]:
                        yield index + i
                    else:
                        doing_pos = False
                if doing_neg and index - i >= 0:
                    if arr[index-i] < arr[index]:
                        yield index - i
                    else:
                        doing_neg = False
            yield -1
        #print("This is stat")
        dp = [-1]*len(arr)
        for i in range(len(arr)):
            #print(i)
            if next(get_valid_neig(i)) == -1:
                dp[i] = 1
        print(dp)
        while True:
            all_done = True
            for i  in range(len(arr)):
                if not (dp[i] == -1):
                    continue
                #print(i)
                all_calc = True
                max_jumps = 1
                for j in get_valid_neig(i):
                    if j == -1:
                        continue
                    #print("Checking ", j, dp[j], max_jumps)
                    if dp[j] == -1:
                        #print(i, j)
                        all_calc = False
                    else:
                        max_jumps = max(max_jumps, 1 + dp[j])
                if all_calc:
                    dp[i] = max_jumps
                if dp[i] == -1:
                    all_done = False
            if all_done:
                break
            print(dp)
        return max(dp)
sol = Solution()
print(sol.maxJumps([6,4,14,6,8,13,9,7,10,6,12], 2))
print(sol.maxJumps([3,3,3,3], 3))
print(sol.maxJumps([22,29,52,97,29,75,78,2,92,70,90,12,43,17,97,18,58,100,41,32], 17))
print(sol.maxJumps([99973,99937,99906,99858,99778,99726,99647,99438,99407,99388,99298,99295,99078,98885,98666,98474,98390,98219,98140,98115,98047,97966,97950,97897,97880,97631,97183,97158,97144,96881,96809,96767,96721,96703,96657,96614,96137,96127,95672,95644,95621,95475,95473,95410,95339,95289,95108,95099,95076,94989,94920,94889,94617,94579,94575,94344,94230,94184,94064,94050,93977,93931,93744,93661,93641,93634,93242,93094,92984,92907,92688,92499,92470,92244,92243,92235,92048,92030,92016,91963,91919,91534,91522,91440,91066,91029,90949,90901,90884,90761,90513,90510,90437,90432,90379,90315,90242,90131,90104,89913,89900,89747,89617,89609,89538,89208,89150,88984,88891,88842,88834,88735,88734,88553,88531,88432,88316,88219,88043,87891,87828,87817,87805,87668,87649,87597,87527,87297,86919,86880,86405,86276,86226,86125,86077,86033,85925,85862,85780,85751,85600,85544,85413,85052,84935,84860,84734,84587,84571,84566,84555,84467,84407,84372,84361,84235,84234,84227,84224,84222,84041,83935,83502,83185,82749,82736,82483,82469,82268,81982,81645,81622,81615,81596,81572,81339,81260,81103,81074,81018,81012,80659,80561,80420,80388,80319,80317,79923,79586,79525,79057,78985,78932,78764,78685,78675,78669,78326,78311,78064,77960,77959,77917,77858,77746,77669,77429,77313,76990,76939,76864,76812,76689,76548,76340,76278,76276,75855,75582,75405,75327,75285,75189,75159,75158,75005,74628,74608,74547,74120,74083,74072,74046,73995,73777,73727,73692,73587,73489,73481,73421,73049,73031,73005,73000,72873,72808,72710,72699,72537,72324,72205,72184,71786,71229,71172,71138,70631,70593,70295,70248,70232,70170,70151,70007,69982,69878,69703,69653,69414,69409,69377,69328,69275,69150,69140,69033,68984,68722,68705,68658,68249,68197,68153,67886,67767,67715,67669,67626,67619,67531,67339,67275,67012,66956,66905,66855,66393,66204,66043,65494,65471,65245,65102,65043,65015,64502,64430,64415,64383,64362,64354,64055,64040,63942,63933,63915,63855,63669,63619,63599,63588,63455,63237,63175,62953,62866,62756,62689,62491,62326,62256,62227,62135,61877,61857,61703,61656,61505,61495,61242,61187,61030,60819,60818,60666,60488,60231,60094,59929,59919,59882,59797,59639,59570,59205,58940,58615,58606,58487,58483,58120,58073,57912,57847,57677,57492,57450,57443,57348,57134,57022,56883,56333,56315,56227,56060,56004,55794,55763,55682,55670,55530,55496,55201,55132,55016,54969,54942,54884,54829,54496,54413,54410,54262,54246,54225,54223,54177,53971,53931,53808,53678,53662,53592,53554,53515,53495,53483,53219,53116,52998,52650,52610,52608,52496,52443,52347,52339,52248,52045,51970,51693,51478,50858,50724,50578,50494,50277,50132,49865,49465,49462,49365,49240,49142,49103,48972,48910,48756,48609,48580,47782,47695,47565,47552,47503,47427,47175,47164,47141,47124,47120,46650,46413,46035,46028,45997,45809,45760,45745,45682,45630,45581,45300,45025,44821,44748,44700,44568,44508,44420,44398,44377,44367,44307,44261,44249,43976,43969,43884,43848,43660,43630,43602,43597,43580,43545,43348,43174,42911,42802,42768,42663,42595,42468,42388,42380,42308,42073,41945,41918,41818,41662,41661,41633,41479,41468,41457,41398,41377,41373,41354,41273,41127,41020,40925,40873,40797,40716,40572,40519,40488,40430,40400,40104,40092,40010,39982,39879,39847,39688,39618,39606,39546,39379,39267,39262,39199,39031,38966,38911,38814,38727,38719,38397,38328,38227,37803,37576,37513,37509,37474,37454,37373,37330,37273,36803,36789,36743,36648,36390,36183,36130,35896,35656,35533,35464,34822,34724,34714,34427,34201,34159,34094,33978,33855,33589,33475,33374,33351,33297,32920,32897,32863,32860,32850,32838,32684,32653,32615,32491,32384,32342,32261,32250,32241,32180,32045,32004,31945,31919,31755,31713,31613,31587,31447,31442,31193,31088,31018,31008,30909,30830,30736,30660,30584,30458,30314,30215,30199,30081,30038,30018,30001,29834,29809,29577,29520,29389,29284,29078,28975,28946,28845,28595,28556,28555,28493,28469,28443,28382,28378,28185,28129,28098,27825,27822,27745,27654,27533,27431,27269,27244,27224,26886,26751,26657,26511,26432,26139,25965,25961,25904,25631,25553,25539,25358,25332,25268,25244,25192,24792,24670,24640,24492,24475,24404,24384,24130,23940,23886,23873,23861,23849,23588,23538,23498,23475,23438,23230,23157,23117,23106,22988,22946,22890,22817,22783,22734,22632,22619,22558,22465,22376,22144,21956,21860,21808,21793,21554,21455,21382,21318,21284,20950,20826,20647,20627,20502,20501,20452,20330,20033,20002,19965,19919,19553,19509,19457,19095,19053,19042,19025,19017,18873,18837,18682,18634,18465,18420,18409,18337,18311,18276,18004,17871,17836,17734,17386,17271,17208,17197,17161,17039,16883,16869,16809,16650,16599,16432,16383,16252,16157,16150,16130,15934,15914,15894,15720,15491,15383,14990,14966,14928,14627,14425,14356,14335,14280,14045,13958,13820,13768,13588,13510,13473,13413,13366,13282,13102,12976,12974,12950,12786,12715,12702,12645,12617,12553,12400,12261,12038,11866,11863,11762,11718,11533,11507,11342,11244,11141,10955,10954,10916,10688,10514,10088,10063,9876,9826,9706,9590,9528,9460,9278,9271,9203,9182,9142,9029,8855,8795,8676,8339,8173,8094,8003,7997,7924,7885,7871,7244,7082,7039,6966,6827,6716,6646,6596,6548,6530,6435,6422,6277,6142,5936,5891,5765,5669,5621,5579,5534,5428,5309,5244,5136,5024,4850,4785,4747,4709,4708,4703,4702,4609,4171,4122,4101,4081,4026,3679,3621,3605,3455,3381,3352,3342,3336,3140,3054,2945,2824,2536,2525,2497,2377,2336,2290,2289,2250,2160,2121,2115,1893,1879,1862,1580,1385,1347,1227,1196,1158,965,866,854,833,778,350,171,39], 507))

